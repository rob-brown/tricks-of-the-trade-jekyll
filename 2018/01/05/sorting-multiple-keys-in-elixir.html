<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>TIL: Sorting by Multiple Keys in Elixir | Tricks of the Trade</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="TIL: Sorting by Multiple Keys in Elixir" />
<meta name="author" content="Robert Brown" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="While working on Advent of Code 2017 I inadvertedly discovered how to sort collections by multiple keys. In the past, I’ve always written elaborate functions like this:" />
<meta property="og:description" content="While working on Advent of Code 2017 I inadvertedly discovered how to sort collections by multiple keys. In the past, I’ve always written elaborate functions like this:" />
<link rel="canonical" href="/2018/01/05/sorting-multiple-keys-in-elixir.html" />
<meta property="og:url" content="/2018/01/05/sorting-multiple-keys-in-elixir.html" />
<meta property="og:site_name" content="Tricks of the Trade" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-05T03:30:00+00:00" />
<script type="application/ld+json">
{"datePublished":"2018-01-05T03:30:00+00:00","author":{"@type":"Person","name":"Robert Brown"},"dateModified":"2018-01-05T03:30:00+00:00","description":"While working on Advent of Code 2017 I inadvertedly discovered how to sort collections by multiple keys. In the past, I’ve always written elaborate functions like this:","url":"/2018/01/05/sorting-multiple-keys-in-elixir.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/01/05/sorting-multiple-keys-in-elixir.html"},"headline":"TIL: Sorting by Multiple Keys in Elixir","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Tricks of the Trade" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Tricks of the Trade</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/hire-me">Hire Me</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">TIL: Sorting by Multiple Keys in Elixir</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-01-05T03:30:00+00:00" itemprop="datePublished">Jan 5, 2018
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Robert Brown</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>While working on <a href="http://adventofcode.com">Advent of Code 2017</a> I inadvertedly discovered how to sort collections by multiple keys. In the past, I’ve always written elaborate functions like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>contacts
|&gt; Enum.sort(fn x, y -&gt;
  if x.last_name == y.last_name do
    x.first_name &lt; y.first_name
  else
    x.last_name &lt; y.last_name
  end
end)
</code></pre></div></div>

<p>Now I’ve found a simpler solution.</p>

<p>In the example above we have a list of contacts to sort by last name then first name. We can do so like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>contacts
|&gt; Enum.sort_by(&amp;{&amp;1.last_name, &amp;1.first_name})
</code></pre></div></div>

<p>That’s it. Just return a tuple with the list of values to sort by. (Note, this example uses <code class="language-plaintext highlighter-rouge">sort_by</code> instead of <code class="language-plaintext highlighter-rouge">sort</code>.) If two contacts have the same last name, then the first names will be compared. This can be done for any number of values.</p>

<p>This works with <code class="language-plaintext highlighter-rouge">min</code> and <code class="language-plaintext highlighter-rouge">max</code> too.</p>

<p>The down side of this approach is that it assumes that you want an ascending or descending sort for all the listed values. In general, you must use an elaborate function to handle mixed sort orders.</p>

<p>There is a special case for numbers though. Let’s say you have a list of games and you want the game with the highest score. However, if two or more games have the same highest score, you want the first game to achieve that score. You can do so like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>games
|&gt; Stream.with_index
|&gt; Enum.max_by(fn {x, n} -&gt; {x.score, -n} end)
|&gt; elem(0)
</code></pre></div></div>

<p>Basically, the index is multiplied by -1 to get the minimum.</p>

<p>Sorting is a common operation and it doesn’t need to be complicated.</p>

  </div><a class="u-url" href="/2018/01/05/sorting-multiple-keys-in-elixir.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Tricks of the Trade</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Tricks of the Trade</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rob-brown"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">rob-brown</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Writing about best development practices and other topics.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
